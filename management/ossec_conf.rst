.. _management_ossec_conf:

==========
ossec.conf
==========

The configuration for OSSEC is mostly held in `/var/ossec/etc/ossec.conf`.


global:
-------


.. _global_email_notification:

email_notification:
^^^^^^^^^^^^^^^^^^^

   enable or disable email alerting.

   **Default:** no

   **Allowed:** yes/no

.. _global_email_to:

email_to:
^^^^^^^^^

   Email address alerts are sent to.

   **Allowed:** Any valid email address.

.. _global_email_from:

email_from:
^^^^^^^^^^^

   Email address the alert emails will come from.

   **Allowed:** Any valid email address.

.. _global_email_reply_to:

reply_to:
^^^^^^^^^

   .. versionadded:: 3.0

   Email "Reply-to" for alert emails.

   **Allowed:** Any valid email address.

.. _global_smtp_server:

smtp_server:
^^^^^^^^^^^^

   Hostname or IP address alert emails will be sent to.

   **Allowed:** IP address or hostname of an smtp server.

.. _global_email_maxperhour:

email_maxperhour:
^^^^^^^^^^^^^^^^^

   The maximum number of emails that can be sent per hour.
   Emails in excess of this will be queued for later distribution.

   **Default:** 12

   **Allowed:** 1-9999

   .. note::

      At the end of the hour any queued emails will be sent together.
      This is true whether email grouping is enabled or disabled.

.. _global_custom_alert_output:

custom_alert_output:
^^^^^^^^^^^^^^^^^^^^

   Specifies a custom format for alerts written to the `alerts.log` file.

   .. code-block:: console

        Variables:
        "$TIMESTAMP"    -       The time the event was processed by OSSEC.
        "$FTELL"        -       Unknown
        "$RULEALERT"    -       Unknown
        "$HOSTNAME"     -       Hostname of the system generating the event.
        "$LOCATION"     -       The file the log messages was saved to.
        "$RULEID"       -       The rule id of the alert.
        "$RULELEVEL"    -       The rule level of the alert.
        "$RULECOMMENT"  -       Unknown
        "$SRCIP"        -       The source IP specified in the log message.
        "$DSTUSER"      -       The destination user specified in the log message.
        "$FULLLOG"      -       The original log message.
        "$RULEGROUP"    -       The groups containing the rule.

   .. note::

      Some OSSEC daemons rely on the standard alerts log format to functon properly.
      Using a custom log format may prevent `ossec-maild` or others from working.

.. _global_stats:

stats:
^^^^^^

   Alerting level for the events generated by the statistical analysis.

   **Default:** 8

   **Allowed:** Any level from 0-16

   .. note::

      XXX I actually have no idea what this does, and the description makes no sense.

.. _global_logall:

logall:
^^^^^^^

   If enabled, `ossec-analysisd` will log all messages it receives to the `archives.log`
   file. The log messages will be prefixed with OSSEC meta-data before being written.

   **Default:** no

   **Allowed:** yes/no

.. _global_memory_size:

memory_size:
^^^^^^^^^^^^

   Sets the memory size for event correlation.

   **Default:** 1024

   **Allowed:** Any size from 16 to 5096

   .. note::

      XXX Here is another one I don't understand.

.. _global_allow_list:

allow_list:
^^^^^^^^^^^

   List of IP addresses that should never be blocked by active response.
   One host should be specified per instance of `allow_list`.
   Multiple `allow_list` options can be specified.

   **Allowed:** Any IP address or netblock

   **Valid on:*** Server and Local

.. _global_host_information:

host_information:
^^^^^^^^^^^^^^^^^

   Alerting level for events generated by the host change monitor.

   **Default:** 8

   **Allowed:** Any level from 0-16

.. _global_jsonout_output:

jsonout_output:
^^^^^^^^^^^^^^^

   ..versionadded:: 2.9.0
   Enable or disable alert logging in a json format.
   Alerts will be saved to `alerts.json`.

   **Default:** no

   **Allowed:** yes/no

Allowed:** Any IP address or netblock

   **Valid on:*** Server and Local

.. _global_prelude_output:

prelude_output:
^^^^^^^^^^^^^^^

   .. deprecated:: 3.4

   Enables or disables output to `Prelude-IDS <https://www.prelude-siem.org/>`_.

   **Default:** no

   **Allowed:** yes/no

   .. warning::

      Support for this is rarely tested, and may not work.
      Consider it deprecated.

